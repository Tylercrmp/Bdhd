Timeweb Cloud — инструкция по развёртыванию (сгенерирована 2025-10-05T22:30:41.510868 UTC)

1) Подготовка
- Убедитесь, что в корне проекта есть файлы: package.json, server.js, Dockerfile.
- Сервер слушает порт из переменной окружения PORT. (это настроено в server.js)

2) Что мы сделали
- Добавлен Dockerfile для многоступенчатой сборки (build + runtime).
- server.js приведён к виду, который отдаёт статическую сборку из /dist (Vite) или из /public.
- Добавлен файл INSTRUCTIONS_TIMEWEB.md с этой инструкцией.

3) Локальная проверка (рекомендуется)
# Установите зависимости
npm install

# Соберите фронтенд (Vite)
npm run build

# Запустите сервер локально
PORT=8080 node server.js

Затем откройте http://localhost:8080

4) Развёртывание на Timeweb Cloud (с Dockerfile)
- Залогиньтесь в https://timeweb.cloud/
- В панели выберите Приложения -> Создать приложение.
- В качестве "Тип приложения" выберите: Dockerfile.
- Загрузите содержимое проекта (в корне должен быть Dockerfile).
- В поле порта укажите 8080 (если Timeweb просит).
- Нажмите Развернуть. Timeweb выполнит сборку Docker image и запустит контейнер.
- В логах сборки проверьте, что npm run build выполнился без ошибок и образ запустился.
- После завершения вы получите URL приложения вида https://<app>.timeweb.app

5) Переменные окружения
- При необходимости добавьте переменные окружения в настройках приложения (например NODE_ENV, API_KEYS).
- PORT управляется автоматически Timeweb, но Dockerfile выставляет 8080 как default.

6) Частые проблемы и отладка
- Если сборка падает из-за зависимостей native, убедитесь, что package.json не содержит бинарных сборок или добавьте соответствующие build-essentials (но это редкий случай для фронтендов).
- Если в проекте используется серверный рендеринг или нестандартная структура, возможно потребуется корректировка Dockerfile.
- Посмотрите логи контейнера в панели Timeweb (Logs) — там будет видно где остановилось выполнение.

7) Пример команд для CI (опционально)
docker build -t myapp:latest .
docker run -p 8080:8080 myapp:latest

